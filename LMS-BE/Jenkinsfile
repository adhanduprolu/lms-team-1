pipeline {
    agent any

    stages {
        stage('Docker Pull MySQL') {
            steps {
                sh 'docker pull adhanduprolu/mysql:latest'
            }
        }

        stage('Remove Old Image') {
            steps {
                sh 'docker rmi -f adhanduprolu/mysql:latest'
            }
        }

        stage('Docker Build MySQL') {
            steps {
                script {
                    import docker

client = docker.from_env()
client.images.pull('adhanduprolu/mysql:latest')
client.containers.run('adhanduprolu/mysql:latest', name='mysql', ports={'3306/tcp': 3306}, environment={'MYSQL_ROOT_PASSWORD': 'Qwerty@123'}, remove=True, detach=True)

                }
            }
        }
    }
}
